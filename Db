CREATE TABLE uploads (
  id INT AUTO_INCREMENT PRIMARY KEY,
  filename VARCHAR(255),
  total_size BIGINT,
  total_chunks INT,
  status ENUM('UPLOADING','COMPLETED') DEFAULT 'UPLOADING',
  final_hash CHAR(64),
  zip_entries JSON,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE chunks (
  id INT AUTO_INCREMENT PRIMARY KEY,
  upload_id INT,
  chunk_index INT,
  status ENUM('PENDING','RECEIVED') DEFAULT 'PENDING',
  received_at TIMESTAMP NULL,
  UNIQUE(upload_id, chunk_index),
  FOREIGN KEY (upload_id) REFERENCES uploads(id) ON DELETE CASCADE
);
